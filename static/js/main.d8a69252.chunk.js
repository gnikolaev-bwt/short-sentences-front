(this["webpackJsonpshort-sentences"]=this["webpackJsonpshort-sentences"]||[]).push([[0],{141:function(e,t,r){"use strict";r.r(t);var a=r(1),c=r(24),n=r.n(c),s=(r(89),r(147)),i=r(146),u=r(31),l=r(9),o=r(14),d=r.n(o),j=r(25),b=r(12),p=r(40),h=function(e,t){var r=null!==t&&void 0!==t?t:12;return e.split(" ").length>r?e.split(" ").slice(0,r).join(" ")+"...":e},O=function(e,t){var r=null!==t&&void 0!==t?t:30;return e.length>r?e.slice(0,r)+"...":e},x=function(e){var t=new RegExp("B[0-9]{2}[0-9A-Z]{7}|[0-9]{9}(X|0-9])").exec(e);return t?null===t||void 0===t?void 0:t[0]:null},m=function(e){var t=new Date(0);return t.setSeconds(e),t.toISOString().substr(14,5)},f=r(41),g=f.c,v=r(29),P=r(3),y=r(26),N=r(8),S=r(37),_=r(46),k=r.n(_),w=k.a.create({baseURL:"https://".concat("amazon23.p.rapidapi.com"),headers:{"x-rapidapi-host":"amazon23.p.rapidapi.com","x-rapidapi-key":"ecd72b8709msh07f4cd4e5a0c83fp1bfae3jsncf9c29afc457"}}),L=k.a.create({baseURL:"https://short-sentences.site"}),C=function e(){Object(S.a)(this,e)};C.getProductDetails=function(){var e=Object(j.a)(d.a.mark((function e(t){var r,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={method:"GET",url:"/product-details",params:{asin:t,country:"US"}},e.next=3,w.request(r);case 3:return a=e.sent,console.log(a.data.result),e.abrupt("return",a.data.result[0]);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C.searchForProduct=function(){var e=Object(j.a)(d.a.mark((function e(t){var r,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={method:"GET",url:"/product-search",params:{query:t,country:"US"}},e.next=3,w.request(r);case 3:return a=e.sent,e.abrupt("return",a.data.result);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C.getProductClusters=function(){var e=Object(j.a)(d.a.mark((function e(t,r,a){var c,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c={method:"GET",url:"/process",params:{asin:r,language:a},cancelToken:t},e.next=3,L.request(c);case 3:if("OK"===(n=e.sent).data.status){e.next=6;break}throw new Error("APP_ERROR ".concat(n.data.error));case 6:return e.abrupt("return",n.data.data);case 7:case"end":return e.stop()}}),e)})));return function(t,r,a){return e.apply(this,arguments)}}();var D,E,R,T=[{asin:"B096BKFG57",lang:"En"},{asin:"B07G853D6N",lang:"En"},{asin:"B01K9S260E",lang:"En"}],z=Object(y.b)("productList/fetchPopularProducts",function(){var e=Object(j.a)(d.a.mark((function e(t,r){var a,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.rejectWithValue,e.prev=1,c=T.map((function(e){return C.getProductDetails(e.asin)})),e.next=5,Promise.all(c);case 5:return e.abrupt("return",e.sent);case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",a(e.t0.message));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,r){return e.apply(this,arguments)}}(),{condition:function(e,t){return!(0,t.getState)().productList.popularProducts.length}}),B=Object(y.b)("productList/searchForProducts",function(){var e=Object(j.a)(d.a.mark((function e(t,r){var a,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.rejectWithValue,e.prev=1,e.next=4,C.searchForProduct(t.query);case 4:return c=e.sent,e.abrupt("return",{query:t.query,products:c});case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",a(e.t0.message));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,r){return e.apply(this,arguments)}}(),{condition:function(e,t){return(0,t.getState)().productList.lastQuery!==e.query}}),F={fetchPopularProducts:z,searchForProducts:B},W=Object(y.c)({name:"productList",initialState:{popularProducts:[],foundProducts:[],lastQuery:null,isPopularLoading:!1,isSearchLoading:!1,popularError:"",searchError:""},reducers:{},extraReducers:(D={},Object(N.a)(D,z.pending.type,(function(e){e.isPopularLoading=!0})),Object(N.a)(D,z.fulfilled.type,(function(e,t){e.popularProducts=t.payload,e.isPopularLoading=!1})),Object(N.a)(D,B.pending.type,(function(e){e.isSearchLoading=!0})),Object(N.a)(D,B.fulfilled.type,(function(e,t){e.foundProducts=t.payload.products,e.lastQuery=t.payload.query,e.isSearchLoading=!1})),D)}).reducer,q=Object(y.b)("productDetails/fetchProductDetails",function(){var e=Object(j.a)(d.a.mark((function e(t,r){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.rejectWithValue,e.prev=1,e.next=4,C.getProductDetails(t.asin);case 4:return e.abrupt("return",e.sent);case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return",a(e.t0.message));case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t,r){return e.apply(this,arguments)}}()),H=Object(y.b)("productDetails/fetchProductClusters",function(){var e=Object(j.a)(d.a.mark((function e(t,r){var a,c,n,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.rejectWithValue,e.prev=1,c=t.cancelToken,n=t.asin,s=t.lang,e.next=5,C.getProductClusters(c,n,s);case 5:return e.abrupt("return",e.sent);case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",a(e.t0.message));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,r){return e.apply(this,arguments)}}()),I={fetchProductDetails:q,fetchProductClusters:H},G=Object(y.c)({name:"productDetails",initialState:{productDetails:null,productClusters:[],isDetailsLoading:!1,isClustersLoading:!1,detailsError:"",clustersError:""},reducers:{},extraReducers:(E={},Object(N.a)(E,q.pending.type,(function(e){e.isDetailsLoading=!0})),Object(N.a)(E,q.fulfilled.type,(function(e,t){e.productDetails=t.payload,e.isDetailsLoading=!1,e.detailsError=""})),Object(N.a)(E,q.rejected.type,(function(e,t){e.isDetailsLoading=!1,e.detailsError=t.payload})),Object(N.a)(E,H.pending.type,(function(e){e.isClustersLoading=!0})),Object(N.a)(E,H.fulfilled.type,(function(e,t){e.productClusters=t.payload,e.isClustersLoading=!1,e.clustersError=""})),Object(N.a)(E,H.rejected.type,(function(e,t){e.isClustersLoading=!1,e.clustersError=t.payload})),E)}).reducer,A=Object(y.a)({reducer:{productList:W,productDetails:G}}),U=Object(P.a)(Object(P.a)({},F),I),K=function(){var e=Object(f.b)();return Object(v.b)(U,e)},Q=r(36),V=r(150),Z=r(143),J=r(2),M=function(e){var t=e.children;return Object(J.jsx)("div",{className:"w-100 h-100 p-5",children:Object(J.jsx)("div",{className:"d-flex flex-column align-items-center text-center",children:t})})},X=function(e){var t=e.src,r=e.height,a=e.bgSize;return Object(J.jsx)("div",{style:{height:null!==r&&void 0!==r?r:"15rem",backgroundImage:t?"url(".concat(t,")"):"none",backgroundColor:t?"none":"#2b2b2b",backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:t?null!==a&&void 0!==a?a:"50%":"100%"}})},Y=r(47),$=r(4),ee=r.n($),te=r(43),re=r.n(te),ae=function(e){var t=e.rating,r=parseFloat(t);return Object(J.jsxs)("div",{className:"d-flex align-items-center",children:[Array.from({length:5}).map((function(e,t){return t<r?Object(J.jsx)("div",{className:ee()(re.a.starWrapper,re.a.filled),children:Object(J.jsx)(Y.a,{})},t):Object(J.jsx)("div",{className:re.a.starWrapper,children:Object(J.jsx)(Y.b,{})},t)})),Object(J.jsx)("div",{className:re.a.ratingWrapper,children:Object(J.jsx)("div",{className:re.a.rating,children:t})})]})},ce=r(148),ne=function(e){var t=e.images,r=e.height,a=e.bgSize;return t.length>1?Object(J.jsx)(ce.a,{interval:null,variant:"dark",children:t.map((function(e,t){return Object(J.jsx)(ce.a.Item,{children:Object(J.jsx)(X,{src:e,height:r,bgSize:a})},t)}))}):Object(J.jsx)(X,{src:t[0],height:r,bgSize:a})},se=function(e){var t=e.details,r=e.isLoading,a=e.error;return Object(J.jsx)(V.a,{children:r?Object(J.jsx)(M,{children:Object(J.jsx)(p.ScaleLoader,{})}):a||!t?Object(J.jsxs)(M,{children:[Object(J.jsx)(Q.b,{size:"48px"}),Object(J.jsx)("div",{className:"mt-2",children:"Some error occurred on product load. Please, check if product with this asin exists or try to visit this page later."})]}):Object(J.jsxs)(J.Fragment,{children:[Object(J.jsx)(ne,{images:t.images,height:"17rem",bgSize:"60%"}),Object(J.jsxs)(V.a.Body,{children:[Object(J.jsx)(V.a.Title,{children:t.title}),Object(J.jsx)("hr",{}),Object(J.jsx)("div",{className:"my-3",children:Object(J.jsx)(ae,{rating:t.reviews.rating})}),t.description&&Object(J.jsxs)(J.Fragment,{children:[Object(J.jsx)("hr",{}),Object(J.jsx)(V.a.Text,{children:O(t.description,100)})]}),Object(J.jsx)("hr",{}),Object(J.jsx)(Z.a,{as:"a",className:"w-100",variant:"outline-dark",href:t.url,target:"_blank",children:"Open in Amazon store"})]})]})})},ie=r(84),ue=r(59),le=r(44),oe=r.n(le),de=function(e){var t=e.cluster,r=Object(a.useState)(!1),c=Object(l.a)(r,2),n=c[0],s=c[1],i=Object(a.useState)(!1),u=Object(l.a)(i,2),o=u[0],d=u[1],j=o?t.sentences.length:5;return Object(J.jsxs)(V.a,{className:ee()(oe.a.card,Object(N.a)({},oe.a.focused,n)),children:[Object(J.jsxs)("div",{className:oe.a.cardHeader,onClick:function(){return s((function(e){return!e}))},children:[Object(J.jsxs)("div",{className:"flex-grow-1 me-3",children:[Object(J.jsx)(V.a.Title,{children:t["cluster description"]}),Object(J.jsx)(V.a.Text,{children:t.group})]}),Object(J.jsxs)("div",{className:"d-flex align-items-center mx-3",children:[Object(J.jsx)(ue.c,{className:"me-1"}),Object(J.jsx)("span",{className:"lead",children:t.statements})]}),Object(J.jsx)("div",{className:"d-flex align-items-center mx-3",children:n?Object(J.jsx)(ue.a,{}):Object(J.jsx)(ue.b,{})})]}),Object(J.jsx)(ie.a,{in:n,children:Object(J.jsxs)("div",{children:[Object(J.jsx)("hr",{className:oe.a.hr}),t.sentences.slice(0,j).map((function(e,t){return Object(J.jsxs)("div",{children:[Object(J.jsx)(Q.a,{}),Object(J.jsx)("span",{className:"ms-2",children:e})]},t)})),Object(J.jsx)("hr",{className:oe.a.hr}),Object(J.jsx)(Z.a,{variant:"light",className:"w-100",onClick:function(){return d((function(e){return!e}))},children:o?"Hide":"Expand reviews"})]})})]})},je=function(e){var t=e.asin,r=e.src,a=e.title,c=e.rating,n=Le(R.ProductDetails,{asin:t,lang:"En"});return Object(J.jsxs)(V.a,{as:u.b,className:"h-100",to:n,children:[Object(J.jsx)(X,{src:r,height:"10rem",bgSize:"40%"}),Object(J.jsxs)(V.a.Body,{children:[Object(J.jsx)(V.a.Title,{children:a}),c&&Object(J.jsx)(ae,{rating:"".concat(c)})]})]})},be=function(e){var t=e.clusters,r=e.isLoading,c=e.error,n=Object(a.useState)(0),s=Object(l.a)(n,2),i=s[0],u=s[1];return Object(a.useEffect)((function(){if(r){u(0);var e=setInterval((function(){u((function(e){return e+1}))}),1e3);return function(){return clearInterval(e)}}}),[r]),Object(J.jsxs)("div",{className:"rounded-3 border p-4",children:[Object(J.jsx)("h4",{children:"Review Summary"}),Object(J.jsx)("hr",{className:"my-4"}),Object(J.jsx)("div",{children:r?Object(J.jsxs)(M,{children:[Object(J.jsx)(p.ClockLoader,{}),Object(J.jsx)("div",{className:"mt-2",children:"It takes about 3 minutes to load reviews"}),Object(J.jsxs)("div",{className:"mt-1",children:["Time passed: ",m(i)]})]}):c&&c.startsWith("APP_ERROR")?Object(J.jsxs)(M,{children:[Object(J.jsx)(Q.b,{size:"48px"}),Object(J.jsx)("div",{className:"mt-2",children:c.substring(10)})]}):c?Object(J.jsxs)(M,{children:[Object(J.jsx)(Q.b,{size:"48px"}),Object(J.jsxs)("div",{className:"mt-2",children:["Some error occurred on reviews load: ",Object(J.jsx)("br",{})," ",c]})]}):t.map((function(e,t){return Object(J.jsx)(de,{cluster:e},t)}))})]})},pe=r(144),he=r(81),Oe=function(e){var t=e.details,r=Object(a.useState)(!1),c=Object(l.a)(r,2),n=c[0],s=c[1],i=Object(a.useState)(4),u=Object(l.a)(i,2),o=u[0],d=u[1];return Object(J.jsxs)(J.Fragment,{children:[Object(J.jsx)(pe.a,{className:"mt-4",children:Object(J.jsx)("hr",{})}),Object(J.jsx)(pe.a,{className:"mt-2",children:Object(J.jsx)("h3",{children:"You'd may also like to see:"})}),Object(J.jsx)(pe.a,{children:t.variants.filter((function(e){return!e.is_current_product})).slice(0,o).map((function(e,t){var r;return Object(J.jsx)(he.a,{md:3,className:"mt-3",children:Object(J.jsx)(je,{asin:e.asin,src:null===(r=e.images[0])||void 0===r?void 0:r.large,title:e.title})},t)}))}),t.variants.length>4&&Object(J.jsx)(pe.a,{className:"justify-content-center mt-3",children:Object(J.jsx)(he.a,{md:6,children:Object(J.jsx)(Z.a,{variant:"outline-dark",className:"w-100",onClick:function(){d(n?4:t.variants.length),s(!n)},children:n?"Hide":"Show more"})})})]})},xe=r(145),me=r(64),fe=r.n(me),ge=function(e){var t=e.popularProducts;return Object(J.jsx)(xe.a,{className:fe.a.cardGroup,children:t.slice(0,3).map((function(e,t){var r=Le(R.ProductDetails,{asin:T[t].asin,lang:T[t].lang});return Object(J.jsxs)(V.a,{className:fe.a.card,as:u.b,to:r,children:[Object(J.jsx)(X,{src:e.main_image,height:"15rem",bgSize:"25%"}),Object(J.jsx)(V.a.Body,{children:Object(J.jsx)(V.a.Title,{children:h(e.title,20)})}),Object(J.jsx)(V.a.Footer,{children:Object(J.jsxs)("small",{className:"text-muted",children:["Most popular ",Object(J.jsx)(Y.b,{})]})})]},t)}))})},ve=r(82),Pe=r.n(ve),ye=function(e){var t=e.foundProducts;return Object(J.jsx)(pe.a,{className:Pe.a.searchRow,children:t.slice(0,12).map((function(e,t){return Object(J.jsx)(he.a,{md:3,className:"mt-3",children:Object(J.jsx)(je,{asin:e.asin,src:e.thumbnail,title:e.title,rating:e.reviews.rating})},t)}))})},Ne=r(65),Se=r.n(Ne),_e=r(83),ke=r(149);!function(e){e.Home="/",e.ProductDetails="/:asin/:lang"}(R||(R={}));var we=[{path:R.Home,component:function(){var e=Object(b.f)(),t=Object(a.useState)(""),r=Object(l.a)(t,2),c=r[0],n=r[1],s=Object(a.useState)("En"),u=Object(l.a)(s,2),o=u[0],h=u[1],O=Object(a.useState)(!0),m=Object(l.a)(O,2),f=m[0],v=m[1],P=g((function(e){return e.productList})),y=P.popularProducts,N=P.foundProducts,S=P.isPopularLoading,_=P.isSearchLoading,k=K(),w=k.fetchPopularProducts,L=k.searchForProducts;Object(a.useEffect)((function(){w()}),[]);var C=function(){var t=Object(j.a)(d.a.mark((function t(r){var a,n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r.preventDefault(),(a=x(c))?(n=Le(R.ProductDetails,{asin:a,lang:o}),e.push(n)):c?(v(!1),L({query:c})):(v(!0),w());case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(J.jsxs)(i.a,{className:Se.a.container,children:[Object(J.jsx)(pe.a,{className:"g-2",children:Object(J.jsx)(he.a,{md:12,children:Object(J.jsx)("h2",{children:"Search for product"})})}),Object(J.jsx)("form",{onSubmit:C,autoComplete:"off",children:Object(J.jsxs)(pe.a,{className:"g-2 mt-2",children:[Object(J.jsx)(he.a,{md:6,lg:8,children:Object(J.jsx)(_e.a,{controlId:"asin",label:"Product name or asin",children:Object(J.jsx)(ke.a.Control,{placeholder:"...",onChange:function(e){return n(e.target.value)}})})}),Object(J.jsx)(he.a,{md:3,lg:2,children:Object(J.jsx)(_e.a,{label:"Select language",children:Object(J.jsx)(ke.a.Control,{as:"select",className:Se.a.select,onChange:function(e){return h(e.target.value)},children:Object(J.jsx)("option",{value:"En",children:"En"})})})}),Object(J.jsx)(he.a,{md:3,lg:2,children:Object(J.jsx)(Z.a,{type:"submit",variant:"primary",className:"w-100 h-100",disabled:_,children:"Search"})})]})}),Object(J.jsxs)(pe.a,{className:"my-5",children:[Object(J.jsx)(he.a,{md:4,children:Object(J.jsx)("hr",{})}),Object(J.jsx)(he.a,{md:4,className:"d-flex justify-content-center",children:Object(J.jsx)("span",{className:"text-nowrap lead",children:f?"Most popular":"Search results"})}),Object(J.jsx)(he.a,{md:4,children:Object(J.jsx)("hr",{})})]}),S||_?Object(J.jsx)(M,{children:Object(J.jsx)(p.HashLoader,{})}):f?Object(J.jsx)(ge,{popularProducts:y}):Object(J.jsx)(ye,{foundProducts:N})]})}},{path:R.ProductDetails,component:function(e){var t=e.match.params,r=t.asin,c=t.lang,n=g((function(e){return e.productDetails})),s=n.productDetails,u=n.productClusters,l=n.isDetailsLoading,o=n.isClustersLoading,d=n.detailsError,j=n.clustersError,b=K(),p=b.fetchProductDetails,h=b.fetchProductClusters;Object(a.useEffect)((function(){p({asin:r});var e=k.a.CancelToken.source();return h({cancelToken:e.token,asin:r,lang:c}),function(){return e.cancel()}}),[r,c]);var O=!l&&(null===s||void 0===s?void 0:s.variants)&&s.variants.length>1;return Object(J.jsxs)(i.a,{className:"pb-5",children:[Object(J.jsxs)(pe.a,{className:"g-4 mt-3",children:[Object(J.jsx)(he.a,{md:5,lg:3,children:Object(J.jsx)(se,{details:s,isLoading:l,error:d})}),Object(J.jsx)(he.a,{md:7,lg:9,children:Object(J.jsx)(be,{clusters:u,isLoading:o,error:j})})]}),O&&Object(J.jsx)(Oe,{details:s})]})}}],Le=function(e,t){return Object.entries(t).reduce((function(e,t){var r=Object(l.a)(t,2),a=r[0],c=r[1];return e.replace(":".concat(a),c)}),e)},Ce=function(){return Object(J.jsx)(s.a,{bg:"dark",variant:"dark",expand:"sm",children:Object(J.jsxs)(i.a,{children:[Object(J.jsx)(s.a.Brand,{as:u.b,to:R.Home,children:"Short Sentences"}),Object(J.jsx)(s.a.Toggle,{}),Object(J.jsx)(s.a.Collapse,{className:"justify-content-end",children:Object(J.jsxs)(s.a.Text,{children:["Using public ",Object(J.jsx)("b",{children:"Amazon API"})]})})]})})},De=function(e){var t=e.children;return Object(J.jsxs)(J.Fragment,{children:[Object(J.jsx)(Ce,{}),t]})},Ee=function(){return Object(J.jsx)(u.a,{basename:"/",children:Object(J.jsx)(b.c,{children:we.map((function(e,t){return Object(J.jsx)(b.a,{exact:!0,path:e.path,render:function(t){var r=e.component;return Object(J.jsx)(De,{children:Object(J.jsx)(r,Object(P.a)({},t))})}},t)}))})})};n.a.render(Object(J.jsx)(f.a,{store:A,children:Object(J.jsx)(Ee,{})}),document.getElementById("root"))},43:function(e,t,r){e.exports={starWrapper:"RatingBlock_starWrapper__2Skqq",filled:"RatingBlock_filled__2X0qQ",ratingWrapper:"RatingBlock_ratingWrapper__3UWBZ",rating:"RatingBlock_rating__2dCgI"}},44:function(e,t,r){e.exports={card:"ClusterDetails_card__33Lc3",cardHeader:"ClusterDetails_cardHeader__7kZ6H",focused:"ClusterDetails_focused__3e7az"}},64:function(e,t,r){e.exports={cardGroup:"ProductsPopular_cardGroup__8SiFo",card:"ProductsPopular_card__1Zk1C"}},65:function(e,t,r){e.exports={container:"Home_container__2dr4v",select:"Home_select__3mtRK",invalidTooltip:"Home_invalidTooltip__3vCgv"}},82:function(e,t,r){e.exports={searchRow:"ProductsSearch_searchRow__LBW1F"}},89:function(e,t,r){}},[[141,1,2]]]);
//# sourceMappingURL=main.d8a69252.chunk.js.map